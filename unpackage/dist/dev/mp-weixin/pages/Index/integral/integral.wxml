<view><block wx:if="{{isClose}}"><store-close vue-id="53af8efd-1" bind:__l="__l"></store-close></block><view class="integral-container"><view class="integral-top"><image class="integral-top-img" src="https://xinshusj-1301305452.cos.ap-guangzhou.myqcloud.com/static/integral_img.png"></image><navigator class="integral-rule" url="{{'/pages/Index/integral/integralRule/integralRule?marchantId='+marchantId}}">积分规则</navigator></view><view class="integral-tool-list-box"><view class="integral-tool-list"><block wx:for="{{toolList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><navigator class="integral-tool-item" url="{{item.url+'?marchantId='+marchantId}}"><image class="integral-tool-item-img" src="{{item.img}}"></image><view class="integral-tool-item-text">{{item.text+" "+(index==0?userintegral:'')}}</view></navigator></block></view></view><view class="integral-change-box"><view class="integral-content-container activity-container"><view class="integral-title-container"><view class="integral-title-left-box"></view><view class="integral-title-text">活动结束倒计时</view></view><van-count-down class="activity-count-down" vue-id="53af8efd-2" use-slot="{{true}}" time="{{signData.countDownTime}}" data-event-opts="{{[['^change',[['changeTime']]],['^finish',[['overActivity']]]]}}" bind:change="__e" bind:finish="__e" bind:__l="__l" vue-slots="{{['default']}}"><block wx:if="{{timeData.days!=0}}"><text class="activity-count-down-text">{{timeData.days}}</text></block><block wx:if="{{timeData.days!=0}}"><text>天</text></block><text class="activity-count-down-text">{{timeData.hours<10?'0'+timeData.hours:timeData.hours}}</text>:<text class="activity-count-down-text">{{timeData.minutes<10?'0'+timeData.minutes:timeData.minutes}}</text>:<text class="activity-count-down-text">{{timeData.seconds<10?'0'+timeData.seconds:timeData.seconds}}</text></van-count-down></view><view class="integral-content-container" style="{{(!haveSignIn?'border-radius: 0 0 20rpx 20rpx;position:relative':'')}}"><view class="integral-title-container"><view class="integral-title-left-box"></view><view class="integral-title-text">当前参与人数</view></view><scroll-view style="width:100%;margin-top:20rpx;" scroll-x="{{true}}"><view class="integral-member-list"><block wx:for="{{signData.signinUserList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><image class="integral-member-img" src="{{item.headimgurl}}"></image></block></view></scroll-view></view><view class="integral-content-container" style="border-radius:20rpx 20rpx 0 0;position:relative;margin-bottom:0rpx;"><view class="integral-title-container"><view class="integral-title-left-box"></view><view class="integral-title-text">七天签到领取积分</view></view><block wx:if="{{signData.signinList[nowDay-1].isSignin==1}}"><block><view data-event-opts="{{[['tap',[['signIn',['$event']]]]]}}" class="integral-sign-in-btn integral-signed-in-btn" bindtap="__e">已签到</view></block></block><block wx:else><view data-event-opts="{{[['tap',[['signIn',['$event']]]]]}}" class="integral-sign-in-btn" bindtap="__e">立即签到</view></block><view class="integral-sign-in-list"><block wx:for="{{signData.signinList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="integral-sign-in-item-box"><block wx:if="{{item.isSignin==1||index==nowDay-1}}"><block><view class="integral-sign-in-item" style="background:#ffffff;"><view class="integral-sign-in-item-status" style="color:#000;">{{item.isSignin==0&&index==nowDay-1?'签到':'已签'}}</view><image class="integral-sign-in-item-image" src="/static/pages/img/index/integral_state1.png"></image><view class="integral-sign-in-add" style="color:#000;">{{"+"+item.score}}</view></view></block></block><block wx:else><block><view class="integral-sign-in-item" style="background:#d8d8d8;border:2rpx solid #999;"><view class="integral-sign-in-item-left-top" style="background:#ffffff;"></view><view class="integral-sign-in-item-status" style="color:#999;">{{index>nowDay-1?weekList[index]:'未签'}}</view><image class="integral-sign-in-item-image" src="/static/pages/img/index/integral_state2.png"></image><view class="integral-sign-in-add" style="color:#999;">{{"+"+item.score}}</view></view></block></block><block wx:if="{{index!=6}}"><view class="integral-sign-in-progress"><block wx:if="{{index<nowDay-1}}"><view class="integral-sign-in-progress-in" style="width:100%;"></view></block><block wx:if="{{index==nowDay-1}}"><view class="integral-sign-in-progress-in" style="width:50%;"></view></block></view></block></view></block></view></view><view class="integral-task-container"><view class="integral-task-top"><view class="integral-title-container"><view class="integral-title-left-box"></view><view class="integral-title-text">做任务赚积分</view></view></view><block wx:for="{{taskList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block wx:if="{{item.type!=6}}"><view class="integral-task-item"><view class="integral-task-item-left"><image style="width:60rpx;height:60rpx;margin-right:12rpx;" src="{{item.icon}}"></image><view class="integral-task-item-content"><view class="integral-task-item-content-top">{{''+item.name+''}}<image style="width:40rpx;height:40rpx;margin:0 10rpx;" src="/static/pages/img/index/integral_icon.png"></image><block wx:if="{{item.type==2}}"><text style="font-size:20rpx;">{{"("+item.description+")"}}</text></block><block wx:else><text>{{"+"+item.score}}</text></block></view><view class="integral-task-item-content-bottom"><block wx:if="{{item.limit!=0}}"><view class="integral-task-item-content-bottom-process"><view class="integral-task-item-content-bottom-process-state" style="{{('width:'+item.announce/item.limit*100+'%')}}"></view></view></block><block wx:if="{{item.limit!=0}}"><text>{{"（"+(item.announce>item.limit?item.limit:item.announce)+"/"+item.limit+"）"}}</text></block><block wx:if="{{item.limit==0}}"><text>可累计</text></block></view></view></view><block wx:if="{{!(item.type==5||item.type==4)}}"><view class="integralTask_content_item_right_btn" data-url="{{item.jump}}" data-event-opts="{{[['tap',[['toFinishTask',['$event']]]]]}}" bindtap="__e">{{''+item.buttonName+''}}</view></block><block wx:if="{{item.announce<item.limit||item.limit==0}}"><button class="integralTask_content_item_right_btn" open-type="share" data-url="{{item.jump}}">{{''+item.buttonName+''}}</button></block><block wx:else><view class="integralTask_content_item_right_btn" style="background:#999;">已完成</view></block></view></block></block></view></view><view class="exchange-list-cintainer"><view class="exchange-list-top"><view class="exchange-list-top-title">积分兑换</view><view class="exchange-list-top-text">积分不停,好礼不断</view></view><view class="exchange-goods-list"><block wx:for="{{exchangeGoodsList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="exchange-goods-item" data-idx="{{index}}" data-event-opts="{{[['tap',[['showDetail',['$event']]]]]}}" bindtap="__e"><image class="exchange-goods-img" src="{{item.imageUuid}}" mode="aspectFill"></image><view class="exchange-goods-content"><view class="goods-name">{{item.presentName}}</view><view class="goods-price-box">{{''+item.score+'积分'}}<view class="goods-type"><block wx:if="{{item.disbursement==1||item.disbursement==3}}"><view class="goods-type-item">到店领取</view></block><block wx:if="{{item.disbursement==2||item.disbursement==3}}"><view class="goods-type-item" style="margin-left:10rpx;">商家配送</view></block></view></view><view class="goods-bottom-box"><view class="goods-bottom-btn" style="{{('background:'+(item.rest>0&&userintegral>=item.score?'':'#999'))}}" data-idx="{{index}}" data-event-opts="{{[['tap',[['showSelectTypeFun',['$event']]]]]}}" catchtap="__e">{{''+(userintegral<item.score?'积分不足':item.rest==0?'库存不足':'立即兑换')+''}}</view><view class="goods-bottom-stock">{{"剩余"+item.rest}}</view></view></view></view></block></view></view></view><task-pop style="position:fixed;top:0;left:0;right:0;z-index:9999;" vue-id="53af8efd-3" showTaskPop="{{showTaskPop}}" text="{{taskText}}" marchantId="{{marchantId}}" bind:__l="__l"></task-pop><van-popup vue-id="53af8efd-4" show="{{showGoodsDetail}}" closeable="{{true}}" position="bottom" close-icon="close" round="{{true}}" data-event-opts="{{[['^close',[['closeDetail']]]]}}" data-com-type="wx" bind:close="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="goods-detail-container"><image class="goods-detail-img" src="{{nowGoodsDetail.imageUuid}}" mode="widthFix"></image><view class="goods-detail-content"><view class="goods-detail-top"><view class="goods-detail-price"><image class="goods-detail-icon" src="/static/pages/img/index/goods_price_icon.png"></image>{{''+nowGoodsDetail.score+'积分'}}</view><view class="goods-detail-label">{{"剩余"+nowGoodsDetail.rest}}</view><block wx:if="{{nowGoodsDetail.disbursement==1||nowGoodsDetail.disbursement==3}}"><view class="goods-detail-label">到店领取</view></block><block wx:if="{{nowGoodsDetail.disbursement==2||nowGoodsDetail.disbursement==3}}"><view class="goods-detail-label">商家配送</view></block></view><view class="goods-detail-name">{{nowGoodsDetail.presentName}}</view><view class="goods-detail-text">{{nowGoodsDetail.descriptions}}</view><view data-event-opts="{{[['tap',[['showSelectTypeFun',['$event']]]]]}}" class="goods-detail-btn" style="{{('background:'+(nowGoodsDetail.rest>0&&userintegral>=nowGoodsDetail.score?'':'#999'))}}" catchtap="__e">{{''+(userintegral<nowGoodsDetail.score?'积分不足':nowGoodsDetail.rest==0?'库存不足':'立即兑换')+''}}</view></view></view></van-popup><van-popup vue-id="53af8efd-5" show="{{showSelectType}}" closeable="{{true}}" position="bottom" close-icon="close" round="{{true}}" data-event-opts="{{[['^close',[['closeType']]]]}}" data-com-type="wx" bind:close="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="selectType"><block wx:if="{{!hideTabs}}"><view class="selectType_title"><block wx:for="{{typeList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block><view class="{{['selectType_title_item '+(selectType==index?item.class:'')]}}" data-index="{{index}}" data-event-opts="{{[['tap',[['changeType',['$event']]]]]}}" bindtap="__e">{{item.name}}</view></block></block></view></block><block wx:if="{{hideTabs}}"><view class="no-select-type">{{selectType?'商家配送':'门店团购'}}</view></block><view class="selectType_content"><block wx:if="{{selectType==0}}"><view class="selectType_content_item"><view class="selectType_content_item_label">到店时间</view>：<view data-event-opts="{{[['tap',[['showTimeSelectFun',['$event']]]]]}}" class="selectType_content_item_box" bindtap="__e"><view class="selectType_content_item_box_input"><view>{{selectedTime?selectedTime:'请选择到店领取时间'}}</view><image style="width:24rpx;height:48rpx;" src="/static/pages/img/index/arrow_right.png"></image></view></view></view></block><view class="selectType_content_item"><view class="selectType_content_item_label">联系方式</view>：<view data-event-opts="{{[['tap',[['toSelectAddress',['$event']]]]]}}" class="selectType_content_item_box" bindtap="__e"><view class="selectType_contemt_item_box_item" style="border-bottom:2rpx solid #f7f7f7;">{{'联系人：'+(selectType==0?toStoreContactMan:logisticsContactMan)+''}}<text style="margin-left:20rpx;">{{selectType==0?toStoreTel:logisticsTel}}</text></view><view class="selectType_contemt_item_box_item">{{"地址："+(selectType==0?toStoreAddress:logisticsAddress)}}</view></view></view><view class="selectType_content_item"><view class="selectType_content_item_label">留言</view>：<view class="selectType_content_item_box_textarea"><textarea maxlength="50" data-event-opts="{{[['input',[['getMessageValue',['$event']]]]]}}" value="{{messageValue}}" bindinput="__e"></textarea><view>{{(messageValue.length<50?messageValue.length:50)+"/50"}}</view></view></view><view data-event-opts="{{[['tap',[['exchangeIn',['$event']]]]]}}" class="selectType_btn" bindtap="__e">提交</view></view></view></van-popup><van-popup vue-id="53af8efd-6" show="{{showTimeSelect}}" position="bottom" data-event-opts="{{[['^close',[['closeTimeSelect']]]]}}" data-com-type="wx" bind:close="__e" bind:__l="__l" vue-slots="{{['default']}}"><van-datetime-picker vue-id="{{('53af8efd-7')+','+('53af8efd-6')}}" type="date" title="请选择年月日" min-date="{{minDate}}" max-date="{{maxDate}}" formatter="{{formatter}}" data-event-opts="{{[['^confirm',[['onInput']]],['^cancel',[['closeTimeSelect']]]]}}" data-com-type="wx" bind:confirm="__e" bind:cancel="__e" bind:__l="__l"></van-datetime-picker></van-popup><van-popup vue-id="53af8efd-8" show="{{isOverTime}}" round="{{true}}" position="center" data-com-type="wx" bind:__l="__l" vue-slots="{{['default']}}"><view class="over-activity-container" style="background-image:url(https://xssj.letterbook.cn/applet/images/integral_overtime_bg.png);"><view class="overtime-title">活动结束</view><view class="overtime-content">请耐心等待商家发布下一轮活动</view><view data-event-opts="{{[['tap',[['closePages',['$event']]]]]}}" class="overtime-btn" bindtap="__e">确认</view></view></van-popup><van-overlay vue-id="53af8efd-9" show="{{isFinishSign}}" z-index="999" bind:__l="__l" vue-slots="{{['default']}}"><view class="sign-in-container" style="background-image:url(https://xinshusj-1301305452.cos.ap-guangzhou.myqcloud.com/basics-New%2F%E9%A6%96%E9%A1%B5_slices%2FMy%2F%E7%AD%BE%E5%88%B0%E9%80%9A%E7%9F%A5.png);"><view data-event-opts="{{[['tap',[['closeSign',['$event']]]]]}}" class="sign-in-container-btn" bindtap="__e">我知道啦！</view></view></van-overlay></view>